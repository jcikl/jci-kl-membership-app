# 批量设置功能使用指南

## 功能概述

批量设置功能允许管理员一次性修改多个会员的信息，提高管理效率。

## 使用方法

### 1. 选择会员
- 在会员列表页面，使用表格左侧的复选框选择要批量设置的会员
- 可以单独选择或使用"全选"功能
- 选中的会员数量会显示在"批量设置"按钮上

### 2. 打开批量设置
- 点击页面头部的"批量设置"按钮
- 系统会显示批量设置模态框

### 3. 选择要设置的字段
支持的批量设置字段包括：

#### 基本信息
- **状态**: 活跃、不活跃、暂停、待审核
- **等级**: 铜牌、银牌、金牌、白金、钻石
- **用户户口类别**: 各种会员类别
- **加入时间**: 设置会员加入日期

#### 个人资料
- **性别**: 男、女
- **种族**: 华人、马来人、印度人、其他
- **国籍**: 输入会员国籍
- **介绍人姓名**: 输入介绍人姓名

#### JCI相关信息
- **JCI职位**: 会长、秘书长、财务等
- **副总裁部门**: 个人发展、商业发展等
- **代理职位**: 是否代理职位

#### 其他设置
- **WhatsApp群组**: 是否加入群组
- **T恤接收状态**: 待处理、已申请、处理中、已送达
- **接受国际业务**: 是、否、愿意探索

### 4. 设置新值
- 根据选择的字段，系统会显示相应的输入控件：
  - **下拉选择**: 状态、等级、性别、种族等
  - **日期选择器**: 加入时间
  - **文本输入**: 国籍、介绍人姓名等
- 选择或输入新的值

### 5. 填写设置原因
- 必须填写批量设置的原因
- 原因会记录在系统中，便于审计和追踪

### 6. 确认设置
- 检查将要影响的会员列表
- 点击"确认设置"按钮执行批量更新

## 功能特性

### 安全性
- 所有批量操作都会记录设置原因
- 操作结果会显示成功和失败的会员数量
- 失败的会员会显示具体错误信息

### 用户体验
- 实时显示选中的会员数量
- 批量设置按钮会根据选择状态启用/禁用
- 操作完成后自动刷新会员列表

### 数据完整性
- 使用Firebase批量写入确保数据一致性
- 自动更新`updatedAt`时间戳
- 支持部分成功的情况处理

## 注意事项

1. **权限要求**: 只有管理员才能使用批量设置功能
2. **数据验证**: 系统会验证设置的值是否符合字段要求
3. **操作记录**: 所有批量操作都会记录在系统中
4. **错误处理**: 如果部分会员更新失败，系统会显示详细的错误信息

## 技术实现

- 使用Firebase的`writeBatch`功能确保批量操作的原子性
- 支持嵌套字段更新（如profile字段）
- 自动处理数据类型转换和验证
- 提供详细的错误报告和成功统计

## 使用场景

1. **会员状态管理**: 批量激活或暂停会员
2. **等级调整**: 批量提升或调整会员等级
3. **个人信息更新**: 批量更新性别、种族、国籍等个人信息
4. **介绍人管理**: 批量设置介绍人姓名
5. **加入时间调整**: 批量修正会员加入时间
6. **职位分配**: 批量分配JCI职位
7. **群组管理**: 批量管理WhatsApp群组成员
8. **服装管理**: 批量更新T恤接收状态

这个功能大大提高了会员管理的效率，特别是在需要同时处理大量会员信息时。
