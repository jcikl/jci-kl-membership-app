# JCI KL 问卷功能使用指南

## 功能概述

JCI KL会员管理系统现已集成完整的问卷功能，支持创建、发布、回答和分析各种类型的问卷。

## 主要功能

### 1. 问卷管理
- **创建问卷**：支持多种问题类型，包括文本、选择、评分、日期等
- **编辑问卷**：可视化编辑器，支持拖拽排序、条件逻辑等
- **发布问卷**：一键发布，支持定时发布和过期设置
- **问卷模板**：预置常用模板，快速创建问卷

### 2. 问题类型
- **文本题**：单行文本、多行文本
- **选择题**：单选题、多选题
- **评分题**：星级评分、NPS评分、滑块评分
- **日期时间**：日期选择、时间选择、日期时间选择
- **其他类型**：邮箱、电话、数字、网址、文件上传等

### 3. 问卷设置
- **目标受众**：可指定特定会员群体
- **问卷配置**：进度条、题号显示、随机排序等
- **时间限制**：设置答题时间限制
- **权限控制**：基于RBAC的细粒度权限管理

### 4. 回答管理
- **在线填写**：响应式设计，支持移动端
- **草稿保存**：自动保存功能，防止数据丢失
- **回答查看**：管理员可查看所有回答
- **数据导出**：支持Excel、CSV等格式导出

### 5. 数据分析
- **实时统计**：回答数量、完成率等基础统计
- **图表分析**：饼图、柱状图、趋势图等可视化分析
- **问题分析**：每个问题的详细分析报告
- **趋势分析**：回答趋势和完成率变化

## 权限说明

### 角色权限矩阵

| 角色 | 创建问卷 | 编辑问卷 | 发布问卷 | 查看回答 | 查看分析 | 提交回答 |
|------|----------|----------|----------|----------|----------|----------|
| 开发者 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 管理员 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 会长 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 秘书长 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 财务长 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 副会长 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 部门主任 | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| 正式会员 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 准会员 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 荣誉会员 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 联合会员 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |
| 拜访会员 | ❌ | ❌ | ❌ | ❌ | ❌ | ✅ |

## 使用流程

### 创建问卷
1. 登录系统，进入"问卷管理"页面
2. 点击"创建问卷"按钮
3. 填写问卷基本信息（标题、描述、类型等）
4. 使用问题编辑器添加问题
5. 配置问卷设置（目标受众、权限等）
6. 预览问卷效果
7. 保存并发布问卷

### 回答问卷
1. 在问卷列表中点击要回答的问卷
2. 点击"填写问卷"按钮
3. 按顺序回答所有问题
4. 检查答案后提交问卷
5. 查看提交成功提示

### 查看分析
1. 进入问卷详情页面
2. 点击"分析"标签页
3. 查看各种统计图表
4. 导出分析报告

## 技术特性

### 前端技术
- **React 18**：现代化的用户界面
- **TypeScript**：类型安全的开发体验
- **Ant Design**：企业级UI组件库
- **React Router**：单页应用路由管理

### 后端技术
- **Firebase Firestore**：NoSQL数据库
- **Firebase Auth**：用户认证
- **Firebase Storage**：文件存储

### 权限系统
- **RBAC**：基于角色的访问控制
- **细粒度权限**：支持到具体操作的权限控制
- **权限继承**：角色权限继承机制
- **动态权限**：运行时权限检查

## 文件结构

```
src/
├── components/survey/          # 问卷相关组件
│   ├── SurveyList.tsx         # 问卷列表组件
│   ├── SurveyForm.tsx         # 问卷表单组件
│   ├── QuestionEditor.tsx     # 问题编辑器组件
│   ├── SurveyPreview.tsx      # 问卷预览组件
│   ├── SurveyResponseForm.tsx # 问卷回答组件
│   └── SurveyAnalytics.tsx    # 问卷分析组件
├── pages/                     # 页面组件
│   ├── SurveyListPage.tsx     # 问卷列表页面
│   ├── SurveyCreatePage.tsx   # 创建问卷页面
│   ├── SurveyEditPage.tsx     # 编辑问卷页面
│   ├── SurveyDetailPage.tsx   # 问卷详情页面
│   └── SurveyResponsePage.tsx # 问卷回答页面
├── services/                  # 服务层
│   ├── surveyService.ts       # 问卷服务
│   ├── surveyTemplateService.ts # 问卷模板服务
│   └── surveyPermissionService.ts # 问卷权限服务
├── hooks/                     # 自定义Hooks
│   └── useSurveyPermissions.ts # 问卷权限Hook
└── types/                     # 类型定义
    └── index.ts              # 问卷相关类型
```

## 扩展功能

### 已实现功能
- ✅ 问卷CRUD操作
- ✅ 问题类型支持
- ✅ 权限控制
- ✅ 数据分析
- ✅ 模板系统
- ✅ 响应式设计

### 待开发功能
- 🔄 问卷分享链接
- 🔄 邮件通知
- 🔄 高级分析功能
- 🔄 问卷协作编辑
- 🔄 移动端优化

## 注意事项

1. **权限管理**：确保用户具有相应的权限才能访问问卷功能
2. **数据安全**：问卷回答数据受到权限保护，只有授权用户才能查看
3. **性能优化**：大量回答数据时建议使用分页加载
4. **浏览器兼容**：建议使用现代浏览器以获得最佳体验

## 技术支持

如有问题或建议，请联系开发团队或查看系统文档。
