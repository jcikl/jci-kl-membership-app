# 交易记录管理3层级体系使用指南

## 📋 概述

交易记录管理系统已升级为支持3层级交易用途体系，提供更精细的交易分类和管理功能。本指南将详细介绍如何使用新的3层级交易用途体系进行交易记录管理。

## 🏗️ 3层级交易用途体系

### 层级结构
```
📁 第一层级：主要分类 (Level 0)
├── 📁 第二层级：业务分类 (Level 1)
│   └── 📁 第三层级：具体用途 (Level 2)
```

### 具体分类
- **收入类** → **会员费** → **2025新会员费**
- **支出类** → **办公支出** → **审计费**
- **其他账户** → **OP/OR** → **运营费用**

## 🚀 主要功能

### 1. 交易记录创建和编辑

#### 创建新交易记录
1. 点击"新增交易"按钮
2. 填写基本信息（日期、银行户口、描述、金额）
3. **选择3层级交易用途**：
   - 使用TreeSelect组件选择
   - 支持搜索和展开/折叠
   - 显示完整的层级路径
4. 设置项目户口和其他信息
5. 保存交易记录

#### 编辑交易记录
1. 点击交易记录旁的编辑按钮
2. 修改需要更新的字段
3. 交易用途选择器会显示当前的3层级路径
4. 保存更改

### 2. 交易用途显示

#### 表格中的用途显示
- **主标签**：显示具体用途名称
- **路径显示**：在标签下方显示完整的层级路径
- **颜色区分**：
  - 蓝色：主交易记录的用途
  - 绿色：拆分记录的用途

#### 示例显示
```
🏷️ 2025新会员费
   收入类 > 会员费
```

### 3. 筛选和搜索功能

#### 多维度筛选
1. **文本搜索**：搜索交易描述、付款人、收款人
2. **交易用途筛选**：
   - 支持多选
   - 树形结构选择
   - 可选择任意层级的用途
3. **日期范围筛选**：选择交易日期范围
4. **清除筛选**：一键清除所有筛选条件

#### 筛选操作
- 在筛选栏中选择条件
- 实时显示筛选结果数量
- 支持组合筛选

### 4. 批量操作

#### 批量设置交易用途
1. 选择多条交易记录
2. 点击"批量设置"按钮
3. 在批量设置模态框中：
   - 使用TreeSelect选择3层级交易用途
   - 快速选择具体用途（显示前6个）
   - 设置项目户口
4. 确认批量设置

#### 批量导入
- 支持Excel文件导入
- 自动匹配3层级交易用途
- 批量创建交易记录

## 📊 界面布局

### 1. 顶部操作栏
- **标题**：显示"交易记录管理 | 3层级交易用途体系"
- **操作按钮**：
  - 批量导入
  - 批量设置（显示选中数量）
  - 新增交易

### 2. 筛选栏
- **搜索框**：文本搜索
- **用途筛选器**：TreeSelect多选
- **日期选择器**：范围选择
- **清除按钮**：重置筛选

### 3. 银行户口标签页
- 按银行户口分组显示
- 每个标签显示交易数量
- 独立的统计信息

### 4. 交易记录表格
- **交易日期**：带日历图标
- **主描述**：支持展开/折叠
- **副描述**：可选字段
- **支出/收入**：货币格式化显示
- **余额**：实时计算
- **付款人/收款人**：合并显示
- **交易用途**：3层级路径显示
- **项目户口**：标签显示
- **操作**：编辑、拆分、删除

## 🔧 技术特性

### 1. 智能筛选
- 实时筛选，无需刷新页面
- 支持多条件组合筛选
- 筛选结果实时统计

### 2. 树形选择器
- 支持搜索功能
- 可展开/折叠节点
- 显示完整层级结构
- 支持多选操作

### 3. 数据验证
- 必填字段验证
- 金额格式验证
- 日期格式验证
- 层级关系验证

### 4. 响应式设计
- 适配不同屏幕尺寸
- 表格横向滚动
- 移动端友好

## 📝 使用技巧

### 1. 快速选择交易用途
- 使用搜索功能快速定位
- 利用快速选择按钮
- 记住常用用途的层级路径

### 2. 批量操作效率
- 先筛选再批量操作
- 使用快速选择功能
- 批量设置前确认选择

### 3. 数据管理
- 定期检查交易用途分类
- 及时更新过时的用途
- 保持数据一致性

## ⚠️ 注意事项

### 1. 数据完整性
- 确保交易用途选择正确
- 检查层级关系是否合理
- 验证金额计算准确性

### 2. 权限管理
- 不同角色有不同的操作权限
- 重要操作需要管理员权限
- 批量操作需要谨慎使用

### 3. 性能考虑
- 大量数据时使用筛选功能
- 避免一次性加载过多记录
- 定期清理无用数据

## 🆘 常见问题

### Q1: 如何快速找到特定的交易用途？
A: 使用TreeSelect的搜索功能，输入关键词即可快速定位。

### Q2: 批量设置时如何选择多个用途？
A: 批量设置只能选择一个用途，如需设置多个不同用途，请分别操作。

### Q3: 筛选后如何恢复显示所有记录？
A: 点击"清除筛选"按钮即可恢复显示所有记录。

### Q4: 交易用途显示不完整怎么办？
A: 检查3层级交易用途体系是否已正确初始化，确保数据完整性。

### Q5: 如何修改已拆分的交易记录？
A: 已拆分的交易记录无法直接修改交易用途，需要先取消拆分。

## 📞 技术支持

如遇到问题，请联系系统管理员或查看相关技术文档。

---

**最后更新**: 2025年1月
**版本**: 1.0.0
**维护者**: JCI KL 财务管理系统团队
